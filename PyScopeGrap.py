import logging
import argparse
from PIL import Image, PngImagePlugin
import serial
import os, sys, time
from byte_reader import ByteReader


def init_logger(opt):
    # Definition logger features see https://docs.python.org/3/howto/logging.html
    logger = logging.getLogger(__name__)

    # configuring log level
    if opt.verbose:
        log_level = logging.DEBUG
    else:
        log_level = logging.INFO

    # ToDo Overwrite of old log files... no need to keep old files
    FORMAT = '%(lineno)s -%(funcName)s %(levelname)s %(message)s'
    logging.basicConfig(filename='example.log', encoding='utf-8', level=log_level, format=FORMAT)

    # writing to stdout
    log_format = logging.Formatter('[%(lineno)s -%(funcName)s] [%(levelname)s] - %(message)s')
    handler = logging.StreamHandler(sys.stdout)
    handler.setLevel(log_level)
    handler.setFormatter(log_format)
    logger.addHandler(handler)

    return logger


def process_arguments():
    # Definition of command line features
    # regarding action="store_true" https://stackoverflow.com/questions/8203622/argparse-store-false-if-unspecified
    parser = argparse.ArgumentParser(prog='PyScopeGrap', description='Handles communication with Fluke 105')
    # Communication parameters
    parser.add_argument('-t', '--tty', dest='tty', help='serial port to use [/dev/vivanco]', default='/dev/vivanco')
    parser.add_argument('-b', '--baud', dest='baud', help='Baudrate [1200]', default='1200')
    # Actions
    parser.add_argument('-i', '--info', help='retrieve info about the scope', action='store_true')
    parser.add_argument('-s', '--status', help='retrieve status info about the scope', action='store_false')
    parser.add_argument('-g', '--grab', help='grab the screen of the scope', action='store_false')
    parser.add_argument('-w', '--wait', help='wait for start print from the scope', action='store_true')
    # -m measurment
    parser.add_argument('-o', '--out', dest='out', help='output-file')
    parser.add_argument('-a', '--auto', dest='auto', help='auto display image', action='store_true')
    # Colors
    parser.add_argument('-f', '--foreground', dest='fg', help='foreground color in #rrggbb', default ='#222222')
    parser.add_argument('-y', '--background', dest='bg', help='background color in #rrggbb', default ='#b1e580')
    # More information
    parser.add_argument('-v', '--verbose', help='increase output verbosity', action='store_false')
    parser.add_argument('-l', '--logging', help='enable logging', action='store_true')
    parser.add_argument('-c', '--comment', help='add extra comment to picture', default='')
    # ToDo add loogging level
    arguments = parser.parse_args()
    return arguments

def check_arguments(opt):
    if opt.grab and opt.wait:
        LOG.error("It doesn't make sense to have wait and grab enabled the same time")
        exit(20);


def display_progress_bar(count, total, suffix=''):
    bar_len = 40
    filled_len = int(round(bar_len * count / float(total)))
    percents = round(100.0 * count / float(total), 1)
    bar = '=' * filled_len + '-' * (bar_len - filled_len)
    sys.stdout.write('[%s] %s%s ...%s\r' % (bar, percents, '%', suffix))


def hex2rgb(hexColor):
    if hexColor[0] == '#':
        hexColor = hexColor[1:]
    elif hexColor[0:2].lower() == '0x':
        hexColor = hexColor[2:]
    if len(hexColor) < 6:
        hexColor = hexColor[0]+'0'+hexColor[1]+'0'+hexColor[2]+'0'
    return int(hexColor[0:2], 16), int(hexColor[2:4], 16), int(hexColor[4:6], 16)


def generate_screenshot_test(opt):
    fg = hex2rgb(opt.fg)
    img = Image.new('RGB', (240, 240), args.bg)  # create a new  image
    pixels = img.load()  # create the pixel map

    for i in range(240):
        pixels[i, i]     = fg
        pixels[i, 119]   = fg  # -
        pixels[119, i]   = fg  # |
        pixels[239-i, i] = fg

    if opt.out == None:
        LOG.debug('file will be saved in current directory')
        opt.out = 'screenshot_'+str(int(time.time()))+'.png'
    img.save(opt.out)
    LOG.debug(opt.out+' saved')
    if opt.auto:
        img.show()


def generate_screenshot(prn, opt):
    fg = hex2rgb(opt.fg)
    img = Image.new('RGB', (240, 240), args.bg)  # create a new  image
    pixels = img.load()  # create the pixel map

    # generate a PngInfo-object for the metadata
    png_info = PngImagePlugin.PngInfo()
    # add metadata
    png_info.add_text('Generator', 'PyScopeGrap V0.1')
    png_info.add_text('Description', 'Exported from Fluke 105')
    png_info.add_text('Extra text', opt.comment)
    ###################################################
    LOG.info(str(len(prn)) + ' bytes received')
    graphmode = False
    graphlen = 0
    i = 0

    #line = 1 ToDo Check why 1 or 0
    line = 0

    xcoord = 0
    while i < len(prn):
        if not graphmode:
            c = prn[i]
            #LOG.debug('i = ', i, hex(c))
            if c == 0x1b:
                i += 1
                if prn[i] == 0x2a:  # *
                    i += 1
                    i += 1
                    graphlen = prn[i]
                    i += 1
                    graphlen += prn[i] * 256
                    graphmode = True
                    # new grafic line with graphlen = F0 = 240 will be ended with  0d 0a
                    xcoord = 0
            elif c == 0x0d:
                line += 1
                #LOG.debug('line = ', line)

            i += 1

        else:
            j = 0
            c = prn[i]
            while j < 8:
                if c & (1 << j):
                    #LOG.debug(' x='+str(xcoord)+' y= '+str((line*8)-j)+' ('+str(line)+' lines), j: '+str(j))
                    if (line > 0) and (line < 31) and (((line * 8) - j) < 240):
                        pixels[xcoord, ((line) * 8) - j] = fg
                j += 1
            graphlen -= 1
            if graphlen == 0:
                graphmode = False  # all 240 pixel are processed
            xcoord += 1
            i += 1

    ###################################################
    if opt.out == None:
        LOG.debug('file will be saved in current directory')
        opt.out = 'screenshot_'+str(int(time.time()))+'.png'
    img.save(opt.out, 'PNG', pnginfo=png_info)

    print(opt.out+' saved')
    if opt.auto:
        img.show()


def calculate_checksum(data):
    checksum = 0
    for byte in data:
        checksum += byte
        checksum %= 256

    return checksum


def send_command(port, command, timeout=True):
    data = bytearray(command.encode('ascii'))
    data.append(ord('\r'))
    port.write(data)
    # port.flush() # check
    ack = port.read(2)

    if len(ack) != 2:
        if timeout:
            LOG.warning('error: command acknowledgement timed out')
            exit(1)
        else:
            return False

    if ack[1] != ord('\r'):
        LOG.warning('error: did not receive CR after acknowledgement code')
        exit(1)

    code = int(chr(ack[0]))

    if code == 0:
        return
    elif code == 1:
        LOG.warning('error: Command syntax error')
    elif code == 2:
        LOG.warning('error: Command execution error')
    elif code == 3:
        LOG.warning('error: Synchronization error')
    elif code == 4:
        LOG.warning('error: Communication error')
    else:
        LOG.warning('error: Unknown error code (' + str(code) + ') in command acknowledgement')
    exit(code)


def get_identity(port):
    LOG.info('Getting identity of ScopeMeter...')
    send_command(port, 'ID')
    identity = bytearray()
    while True:
        byte = port.read()
        if len(byte) != 1:
            LOG.warning('error: timeout while receiving data')
            exit(1)
        if byte[0] == ord('\r'):
            break
        identity.append(byte[0])

    LOG.debug(identity)
    identity = identity.split(b';')
    LOG.debug(identity)
    if len(identity) != 6:  # 6 is for fluke 105
        LOG.warning('error: unable to decode identity strin')
        exit(1)

    # ToDo
    #Getting identity of ScopeMeter...bytearray(b'ScopeMeter 105 Series II; V7.15; 96-02-06; English V2.15; German V2.15; UHM V1.0')
    #[bytearray(b'ScopeMeter 105 Series II'), bytearray(b' V7.15'), bytearray(b' 96-02-06'), bytearray(b' English V2.15'), bytearray(b' German V2.15'), bytearray(b' UHM V1.0')]

    model = identity[0].decode()
    firmware = identity[1].decode()
    #date = time.strptime(identity[2].decode(), '%y-%m-%d')
    #languages = identity[3].decode()
    # print('done')
    print('     Model: '+model)
    print('   Version:'+firmware)
    #print('Build Date: '+time.strftime('%B %d, %Y', date))


def get_satus(port):
    status_text = {
        # from fluke manual
        # pos | Status Description         | value        SC ME DI OM EX CO
        # -----------------------------------------------------------------
        0: 'Hardware settled',              # 1           X  X  X  X  X  X
        1: 'Acquisition armed',             # 2           X  X  X  X  X  X
        2: 'Acquisition triggered',         # 4           X
        3: 'Acquisition busy',              # 8           X  X  X  X  X  X
        4: 'WAVEFORM A memory filled',      # 16          X  X  X  X  X  X
        5: 'WAVEFORM B memory filled',      # 32          X              X
        6: 'WAVEFORM A+/-B memory filled',  # 64          X
        7: 'Math function ready',           # 128         X  X  X  X  X
        8: 'Numeric results available',     # 256         X  X  X  X  X
        9: 'Hold mode active',              # 512         X  X  X  X  X  X
    }

    LOG.info('Getting status of ScopeMeter...')
    send_command(port, 'IS')
    input = bytearray()
    while True:
         byte = port.read()
         if len(byte) != 1:
             LOG.warning('error: timeout while receiving data')
             exit(1)
         if byte[0] == ord('\r'):
             break
         input.append(byte[0])
    LOG.debug(input)
    status = int(input)
    LOG.debug(status)

    for pos in range(len(status_text)):
        if status & (1 << pos):
            print(f"Bit {pos} set: {status_text[pos]}")

    return status


def get_screenshot(port, options):
    print('Downloading screenshot from ScopeMeter...')

    old_timeout = port.timeout
    port.timeout = None

    send_command(port, 'QP')

    LOG.debug('# Read length')
    ascii_chars = port.read(4)
    LOG.debug(ascii_chars)
    ascii_string = str(ascii_chars)
    LOG.debug(ascii_chars)
    # ToDo
    #length = int(ascii_string)
    #LOG.debug(length)
    LOG.debug('# Read ,')
    LOG.debug(port.read(1))
    LOG.debug('# Read data')
    epson = port.read(7454)
    LOG.debug(epson)
    LOG.debug(len(epson))
    LOG.debug('# Read CRC')
    crc_from_device = int.from_bytes(port.read(1))
    LOG.debug(crc_from_device)
    crc_calculated = calculate_checksum(epson)
    LOG.debug(crc_calculated)
    if crc_from_device != crc_calculated:
        LOG.warning('CRC-Error')

    port.timeout = old_timeout

    generate_screenshot(epson, options)


def initialize_port(opt):
    LOG.info('Opening and configuring serial port...')
    # ToDo Add Timeout
    port = serial.Serial(opt.tty, 1200, timeout=1)  # 1200 ist default start baudrate
    print('done')

    print(opt.baud)
    if True:
        LOG.info('Reconciling serial port baud rate...')
        status = send_command(port, 'PC 19200', False)
        port.baudrate = 19200
        if status == False:
            send_command(port, 'PC 19200')
        print('done')

    return port


if __name__ == '__main__':
    # Simulation
    file_path = 'data.txt'

    args = process_arguments()

    LOG = init_logger(args)
    LOG.info('PyScopeGrap V0.1')
    LOG.debug('Test')
    LOG.debug(args)

    check_arguments(args)

    #fluke = ByteReader(file_path)
    fluke = initialize_port(args)

    get_identity(fluke)

    if args.status:
        get_satus(fluke)

    if args.grab:
        get_screenshot(fluke, args)

    exit(0)

    # # this is the simulation part
    # epson = b'\x1b@\x1bM\x1bk\x01 ScopeMeter 105 Series II\r\n\x1bA\x08\x1b*\x04\xf0\x00\xff\xe0\xdb\xbb\xdb\xe0\xff\x00\x00\x00\x00\x00\x00\x00\x00!\x7f\x01\x00\x00>AIA>\x00\x1f\x10\x0f\x10\x0f\x00p\x0c\x03\x0cp\x00\x00\x7fAAA>\x00>AAA"\x00\x00\x00!\x7f\x01\x00\x00\x00\x0066\x00\x00\x00!\x7f\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x80\xb6\xb6\xb6\xc9\xff\x00rQQQN\x00>AIA>\x00>AIA>\x00\x1f\x10\x0f\x10\x0f\x00p\x0c\x03\x0cp\x00\x00>AAA>\x00\x7fHHH@\x00\x7fHHH@\x00\x00\x00!\x7f\x01\x00\x00\x00\x0066\x00\x00\x00!\x7f\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x7f \x10\x08\x7f\x00>AAA>\x00@@\x7f@@\x00\x7fHLJ1\x00\x00A\x7fA\x00\x00>AII/\x00\r\n\x1b*\x04\xf0\x00\x80\x80\x80\x80\x80\x80\x80\x10!"$\x18\x00\x1f $ \x1f\x00\x0f\x08\x07\x08\x07\x00\x04\n\n\n\x01\x00\x01\x02\x04\x08\x10\x00?   \x1f\x00\x00 ? \x00\x008\x06\x01\x068\x00\x00\x00\x00\x00\x00\x00  ?  \x00\x00\x0f\x04\x08\x0c\x00\x00(/\x00\x00\x00\x06\t\t\t\x0f\x00\x00\x00\x1b\x1b\x00\x00\x0f\x12"\x12\x0f\x00  ?\x80\x80\x80\x80\x80\x84\x84\x04\x04\x04\x00\x10!"$\x18\x00?   \x1f\x00\x00 ? \x00\x008\x06\x01\x068\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00?\x10\x0e\x10?\x00\x0f\x12"\x12\x0f\x00?\x10\x08\x04?\x00?\x00\x00\x00?\x00\x0f\x12"\x12\x0f\x00?\x00\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00\x10\x00\x00\x00\x00\x10\x00\x80\x80\x80\x90\x80\x00\x00\x80\x90\x80\x00\x00\x80\x10\x80\x00\x80\x00\x90\x80\x80\x80\x00\x10\x00\x00\x00\x00\x10\x00\x80\x80\x80\x90\x00\x00\x00\x80\x90\x80\x00\x08\x08\x1f\x88\x08\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x80\x00\x10\x00\x00\x80\x00\x10\x00\x00\x80\x80\x90\x80\x00\x00@P@@\x80\x00\x10\x00\x00\x00\x00\x10\x80\x00\x00\x00\x90\x00\x00\x00\xc0P@\x00\x00\x00\x10\x00\x00\x00\x00\x10\x80\x80\x80\x80\x90\x00\x80\x80\x80\x90\x00\x00\x00\x80\x90\x80\x00\x00\x00\x10\x80\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x80\x10\x00\x00\x80\x00\x90\x00\x00\x00\x80\x10\x80\x00\x00\x00\x90\x00\x00\x80\x80\x90\x00\x00\x80\x00\x10\x00\x80\x00\x80\x90\x80\x80\x80\x00\r\n\x1b*\x04\xf0\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00d\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x85\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\r\n\x1b*\x04\xf0\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x81=mmm=\xbd\xbd\xbd=mEm=\x81\xff\x00\x00\r\n\x1b*\x04\xf0\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\x08\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00\x84\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x84\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x84\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x84\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x84\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x84\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x84\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x84\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x84\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\x84\x00\x00\x00\x00\x04\x00\x00\x00\x00\x04\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00B\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00B\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00B\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00B\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00B\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00B\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00B\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00B\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00B\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00B\x00\x00\x00\x00\x02\x00\x00\x00\x00\x02\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00!\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00!\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00!\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00!\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00!\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00!\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00!\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00!\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00!\x00\x03\x03\x03\x02\x03\x00>H\x89H>\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00!\x00\x00\x00\x00\x01\x00\x00\x00\x00\x01\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00\x88\x80\xe0```@@`!!a` \xe0\xc0\xc0\xc0@````@@H@`\xe0\xe0`@@@```\xe0\xc0@@``@@@``@@h`\xc0\xc0@@@@\xc0\xc0@``\xc0\xc0@` `\xc0\xe0 `@@\xc8\xc0@@\xc0\xc0@@@@@``@``@@@``@@` \xe8\xe0`@@@@@@@@@@@@`  `@`\xe0\xe0`@h```@\xc0\xc0@@@``@pp@@\xc0\xc0``@@` h@\xc0\xc0@``@@@@@@\xc0\xc0``@@`\xe0\xc0@@@H`  `@@@\xc0\xe0```@@@@@@@``@@@H@\xc0\xc0\xc0\xe0\xe0@@@@@` `@@``@``@\xc0\xc0h `@\xc0\xc0@@@` `\xc0\xc0@\r\n\x1b*\x04\xf0\x00B\x00\x00\x08TTT<\x00\x00\x00\xfe\x02\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00\x84\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x84\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x84\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x84\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x84\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x84\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x84\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x84\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x84\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\x84\x00\x00\x00\x00\x80\x00\x00\x00\x00\x80\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00!\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00B\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00B\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00B\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00B\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00B\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00B\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00B\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00B\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00B\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00B\x00\x00\x00\x00@\x00\x00\x00\x00@\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x84\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00!\x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00!\x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00!\x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00!\x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00!\x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00!\x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00!\x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00!\x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00!\x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00!\x00\x00\x00\x00 \x00\x00\x00\x00 \x00\x00\x00\x00\r\n\x1b*\x04\xf0\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00???>????>>>???>>>??>???>?>>>>>?>>>>?????\r\n\x1b*\x04\xf0\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00B\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xaf\'#\'\xaf\xff\x07\xfb\xfb\xfbw\xff\x07\xfb\xfb\xfb\x07\xff\x03\x7f\xbf\xdf\x03\xff\xff\xff\x03\xff\xff\xff\x03\xdf\xcf\xd7;\xff\xff\xff\xff\r\n\x1b*\x04\xf0\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x00\x00\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\xf0\r\n\x1b*\x04\xf0\x00\xff\xe0\xc0\xce\xce\xce\xce\xc6\xe7\xff\xe0\xc0\xcf\xcf\xcf\xcf\xc7\xe7\xff\xe0\xc0\xcf\xcf\xcf\xcf\xc0\xe0\xff\xc0\xc0\xce\xce\xce\xce\xc0\xe0\xff\xc0\xc0\xce\xce\xce\xce\xce\xcf\xff\x00\x00\x00\x00??\x18\x0f\x0f\x18??\x00??111110\x00000??000\x00??111110\x00??1111?\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07\x0f\x1c800008\x1c\x0f\x07\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01?\x1f\x0f\x07\x03\x01??\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00??111110\x008>\x0f\x03\x03\x0f>8\x00000??000\x00\x07\x07\x06\x03\x07\x06\x07\x03\x00<?\x03\x00\x00\x03?<\x00\x00\x00\r\n\x1b*\x04\xf0\x00\xff\xe7cssss\x03\x07\xff\x07\x03\xf3\xf3\xf3\xf3\xe3\xe7\xff\x07\x03\xf3\xf3\xf3\xf3\x03\x07\xff\x03\x03\x7f\x7f\x7f\x7f\x7f\xff\xff\x03\x03sssss\xf3\xff\x00\x00\x00\x00\xfc\xfc\x00\x80\x80\x00\xfc\xfc\x00\xfc\xfc\x8c\x8c\x8c\x8c\x8c\x0c\x00\x00\x00\x00\xfc\xfc\x00\x00\x00\x00\xfc\xfc\x8c\x8c\x8c\x8c\x8c\x0c\x00\xfc\xfc\xc0\xe0\xf0\xb8\x9c\x0c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\xcc\xec|<\x00\x00<|\xec\xcc\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x80\x80\xfc\xf8\xf0\xe0\xc0\x80\xfc\xfc\x80\x80\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xfc\xfc\x8c\x8c\x8c\x8c\x8c\x0c\x00\x1c|\xf0\xc0\xc0\xf0|\x1c\x00\x00\x00\x00\xfc\xfc\x00\x0c\x0c\x00\xfc\xfc\x00\xfc\xfc\x00\xfc\xfc\x00\x00\xc0\xf0<<\xf0\xc0\x00\x00\x00\x00\r\n\r\n\n\n\n\x1b@'
    #
    #
    # fluke = ByteReader(file_path)
    #
    # # Test QP
    # #fluke.write(b'QP\r')
    #
    # print('# Read ACK')
    # response = fluke.read(2)
    # print('# Read length')
    # ascii_chars = fluke.read(4)
    # print(ascii_chars)
    # ascii_string = str(ascii_chars)
    # print(ascii_chars)
    # #length = int(ascii_string)
    # #print(length)
    # print('# Read ,')
    # print(fluke.read(1))
    # print('# Read data')
    # epson2 = fluke.read(7454)
    # print(epson2)
    # print('# Read CRC')
    # print(fluke.read(1))
    # # this is the real part
    #
    # ### fluke = serial.Serial(args.tty, args.baud)
    # # initialize_port(args)
    #
    # # # Test ID
    # ### fluke.write(b'ID\r')
    # # send_command('ID')
    # # response = fluke.read(2)
    # # resultb = fluke.read_until(b'\r')
    # # results = resultb.decode()
    # # print('\r')
    # # print(results)
    # #
    # # if not 'ScopeMeter 105 Series' in results:
    # #     print('Device not supported')
    # #     fluke.close()
    # #     exit(-2)
    # #
    # # # Test QP
    # # fluke.write(b'QP\r')
    # # print('# Read ACK')
    # # ack = fluke.read(2)
    # #
    # # print('# Read length')
    # #
    # # ascii_chars = fluke.read(4)
    # # print(ascii_chars)
    # # ascii_string = str(ascii_chars)
    # # print(ascii_chars)
    # # #length = int(ascii_string)
    # # #print(length)
    # #
    # # print('# Read ,')
    # # print(fluke.read(1))
    # #
    # # print('# Read data')
    # # epson = fluke.read(7454)
    # # print(epson)
    # # print('# Read CRC')
    # # print(fluke.read(1))
    # #
    # # fluke.close()
    # #
    # # # generate_screenshot_test(args)
    # generate_screenshot(epson2, args)




#############################


# ideen name seriall inst
# inst.query(:IDN)
# scpi commands
# https://medium.com/@dantondds/a-beginner-guide-on-programming-instruments-applying-scpi-protocol-using-python-e415e328cdc1
# https://pyvisa.readthedocs.io/en/latest/
# https://pypi.org/project/easy-scpi/
# https://goughlui.com/2021/03/28/tutorial-introduction-to-scpi-automation-of-test-equipment-with-pyvisa/


# https://github.com/StefanMack/PraktMesstVISA/blob/master/AutomMessenMitPython.ipynb
# https://en.wikipedia.org/wiki/Standard_Commands_for_Programmable_Instruments
# https://www.ivifoundation.org/downloads/SCPI/scpi-99.pdf

# https://learnpython.com/blog/argparse-module/
# https://www.freecodecamp.org/news/python-bytes-to-string-how-to-convert-a-bytestring/
# https://stackoverflow.com/questions/606191/convert-bytes-to-a-string-in-python-3
# https://www.pythonpool.com/python-bytes-to-string/
# https://www.freecodecamp.org/news/python-bytes-to-string-how-to-convert-a-bytestring/
# https://www.geeksforgeeks.org/how-to-convert-bytes-to-string-in-python/
# https://docs.python.org/3/howto/argparse.html


# Send a query to the ScopeMeter and return the ACK response.
# The remaining response data, if it exists, can be retrieved with GetFlukeResponse
# query_fluke(wxString cmdString, bool bAsciiMode, DWORD msTimeout, bool* ResponseIsOK)

# Wait to receive a complete response from the ScopeMeter
# Get_Fluke_Response(DWORD msTimeout)


# unsupported
# else
    # unsupported model
    # mScopemeterType = SCOPEMETER_NONE;
    # bFlukeDetected = false;
    # infoStr = '(unsupported) ' + infoStr;
